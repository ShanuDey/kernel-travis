language: C
sudo: required

before_install:
  - sudo apt-get update
  - sudo apt-get install -y git zip 
before_script:
  - cd $HOME && PATH=~/bin:$PATH
  - curl https://storage.googleapis.com/git-repo-downloads/repo > ~/bin/repo
  - chmod a+x ~/bin/repo
script:
  - cd $HOME && git clone https://github.com/raza231198/kernel_realme_sdm660.git kernel
  - cd $HOME/kernel && git remote rm origin
  - git remote add origin https://github.com/iamsaalim/kernel_realme_sdm660.git
  - git push -q https://$GITHUB_TOKEN@github.com/iamsaalim/kernel_realme_sdm660.git HEAD:master
deploy:
  skip_cleanup: true
  provider: releases
  api_key: "$GITHUB_TOKEN"
  file_glob: true
  file: $HOME/out/arch/arm64/boot/*gz

  on:
    tags: false
    repo: iamsaalim/kernel_script
    branch: master
branches:
  except:
    - /^(?i:untagged)-.*$/
